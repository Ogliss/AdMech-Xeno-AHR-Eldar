<?xml version="1.0" encoding="utf-8" ?>
<Patch>
	<!-- Craftworld Hospitality Quest Support Link -->
	<Operation Class="PatchOperationOptional">
		<patchName>AeldariHospitalityQuestSupport</patchName>
		<label>Aeldari Hospitality Quest Support</label>
		<toolTip>Adds support to the Royalty Hospitality quest for Aeldari factions</toolTip>
		<log>true</log>
		<enabled Class="PatchOperationSequence">		
			<operations>	
				<li Class="PatchOperationAdd">
					<xpath>/Defs/QuestScriptDef[defName="Util_ChooseRandomQuestLodgerKind"]/root[@Class="QuestNode_Sequence"]/nodes/li[@Class="QuestNode_IsSet"]/node[@Class="QuestNode_GetRandomPawnKindForFaction"]/choices</xpath>
					<value>
						<!--li>
							<factionDef>EmpireAeldariCraftworld</factionDef>
							<pawnKinds>
							  <li>Empire_Common_Lodger</li>
							</pawnKinds>
						</li-->
						<li>
							<categoryTag>OG_Outlander_Aeldari_Asuryani</categoryTag>
							<pawnKinds>
							  <li>Colonist_OG_Eldar_Craftworld</li>
							</pawnKinds>
						</li>
						<li>
							<categoryTag>OG_Outlander_Aeldari_Drukhari</categoryTag>
							<pawnKinds>
							  <li>Colonist_OG_DarkEldar_Kabal</li>
							</pawnKinds>
						</li>
						<!--li>
							<categoryTag>OG_Outlander_Aeldari_Exodite</categoryTag>
							<pawnKinds>
							  <li>Colonist_OG_Eldar_Exoditel</li>
							</pawnKinds>
						</li-->
					</value>
				</li>
				<li Class="PatchOperationAdd">
					<xpath>/Defs/QuestScriptDef[defName="Util_ChooseRandomQuestHelperKind"]/root[@Class="QuestNode_Sequence"]/nodes/li[@Class="QuestNode_GetRandomPawnKindForFaction"]/choices</xpath>
					<value>
						<!--li>
							<factionDef>EmpireAeldariCraftworld</factionDef>
							<pawnKinds>
							  <li>Empire_Common_Lodger</li>
							</pawnKinds>
						</li-->
						<li>
							<categoryTag>OG_Outlander_Aeldari_Asuryani</categoryTag>
							<pawnKinds>
							  <li>OG_Eldar_Guardian</li>
							  <li>OG_Eldar_GuardianStorm</li>
							  <li>OG_Eldar_GuardianSupport</li>
							  <li>OG_Eldar_Ranger</li>
							</pawnKinds>
						</li>
						<li>
							<categoryTag>OG_Outlander_Aeldari_Drukhari</categoryTag>
							<pawnKinds>
							  <li>OG_DarkEldar_Cadet</li>
							  <li>OG_DarkEldar_Kabalite_Ranged</li>
							  <li>OG_DarkEldar_Kabalite_Melee</li>
							  <li>OG_DarkEldar_Kabalite_Support</li>
							  <li>OG_DarkEldar_Kabalite_Sybarite</li>
							</pawnKinds>
						</li>
					</value>
				</li>
				
				<li Class="PatchOperationConditional">
					<xpath>/Defs/QuestScriptDef[defName="Hospitality_Animals"]/root[@Class="QuestNode_Sequence"]/nodes/li[@Class="QuestNode_GetPawnKind"]</xpath>
					<match Class="PatchOperationReplace">
						<xpath>/Defs/QuestScriptDef[defName="Hospitality_Animals"]/root[@Class="QuestNode_Sequence"]/nodes/li[@Class="QuestNode_GetPawnKind"]</xpath>
						<value>
							<li Class="QuestNode_IsSet">
							  <name>asker</name>
							  <node Class="QuestNode_GetRandomPawnKindForFaction">
								<factionOf>$asker</factionOf>
								<storeAs>lodgersPawnKind</storeAs>
								<choices>
									<li>
										<categoryTag>OG_Outlander_Aeldari_Asuryani</categoryTag>
										<pawnKinds>
											<li>OG_Gyrinx</li>
										</pawnKinds>
									</li>
									<li>
										<categoryTag>OG_Outlander_Aeldari_Exodite</categoryTag>
										<pawnKinds>
											<li>OG_Gyrinx</li>
										</pawnKinds>
									</li> 
									<li>
										<categoryTag>OG_Outlander_Aeldari_Drukhari</categoryTag>
										<pawnKinds>
											<li>OG_Gyrinx</li>
										</pawnKinds>
									</li>              
								</choices>
							  </node>
							  <elseNode Class="QuestNode_GetPawnKind">
								<storeAs>lodgersPawnKind</storeAs>
								<options>
								  <li>
									  <anyAnimal>true</anyAnimal>
									  <onlyAllowedFleshType>Normal</onlyAllowedFleshType>
									  <weight>1</weight>
								  </li>
								</options>
							  </elseNode>
							</li>
						</value>
					</match>
				</li>
			</operations>	
		</enabled>	
	</Operation>
</Patch>
